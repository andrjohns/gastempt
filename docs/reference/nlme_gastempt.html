<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simplified population fit of gastric emptying data — nlme_gastempt • gastempt</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simplified population fit of gastric emptying data — nlme_gastempt" />

<meta property="og:description" content="Compute coefficients v0, tempt and kappa of a mixed model fit to a linexp
function with one grouping variable" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gastempt</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/gastempt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/dmenne/gastempt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simplified population fit of gastric emptying data</h1>
    <small class="dont-index">Source: <a href='http://github.com/dmenne/gastempt/blob/master/R/fitnlme.R'><code>R/fitnlme.R</code></a></small>
    <div class="hidden name"><code>nlme_gastempt.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Compute coefficients v0, tempt and kappa of a mixed model fit to a linexp
function with one grouping variable</p>
    
    </div>

    <pre class="usage"><span class='fu'>nlme_gastempt</span>(<span class='no'>d</span>, <span class='kw'>pnlsTol</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>linexp</span>, <span class='kw'>variant</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>A data frame with columns</p><ul>
<li><p><code>record</code> Record descriptor as grouping variable, e.g. patient ID</p></li>
<li><p><code>minute</code> Time after meal or start of recording.</p></li>
<li><p><code>vol</code> Volume of meal or stomach</p></li>
</ul></td>
    </tr>
    <tr>
      <th>pnlsTol</th>
      <td><p>The value of pnlsTol at the initial iteration.
See <code><a href='http://www.rdocumentation.org/packages/nlme/topics/nlmeControl'>nlmeControl</a></code>  When the model does not converge, <code>pnlsTol</code> is multiplied by 5 and the iteration repeated until convergence or <code>pnlsTol &gt;= 0.5</code>. The effective value of  <code>pnlsTol</code> is returned in a separate list item. When it is known that a data set converges badly, it is recommended to set the initial <code>pnlsTol</code> to a higher value, but below 0.5, for faster convergence.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p><code>linexp</code> (default) or <code>powexp</code></p></td>
    </tr>
    <tr>
      <th>variant</th>
      <td><p>For both models, there are 3 variants</p><ul>
<li><p><code>variant = 1</code> The most generic version with independent estimates
  of all three parameters per record
  (<code>random = v0 + tempt + kappa ~ 1 | record</code>). The most likely to fail
  for degenerate cases. If this variant converges, use it.</p></li>
<li><p><code>variant = 2 </code> Diagonal random effects (<code>random = pdDiag(v0 + tempt + kappa) ~ 1; groups =  ~record </code>). Better convergence in critical cases. Note:  I never found out why I have to use the <code>groups</code> parameter instead of the <code>|</code>; see also p. 380 of Pinheiro/Bates.</p></li>
<li><p><code>variant = 3</code> Since parameters <code>kappa</code> and <code>beta</code> respectively are the most difficult to estimate, these are fixed in this variant (<code>random = v0 + tempt ~ 1</code>). This variant converges in all reasonable cases, but the estimates of <code>kappa</code> and <code>beta</code> cannot be use for secondary between-group analysis. If you are only interested in <code>t50</code>, you can use this safe version.</p></li>
</ul></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class nlme_gastempt with elements
<code>coef, summary, plot, pnlsTol, message</code></p><ul>
<li><p><code>coef</code> is a data frame with columns:</p><ul>
<li><p><code>record</code> Record descriptor, e.g. patient ID</p></li>
<li><p><code>v0</code> Initial volume at t=0</p></li>
<li><p><code>tempt</code> Emptying time constant</p></li>
<li><p><code>kappa</code> Parameter <code>kappa</code> for
            <code>model = linexp</code></p></li>
<li><p><code>beta</code> Parameter <code>beta</code> for <code>model = powexp</code></p></li>
<li><p><code>t50</code> Half-time of emptying</p></li>
<li><p><code>slope_t50</code> Slope in t50; typically in units of ml/minute</p></li>
</ul><p>On error, coef is NULL</p></li>
<li><p><code>nlme_result</code> Result of the nlme fit; can be used for addition
     processing, e.g. to plot residuals or via <code>summary</code> to extract AIC.
     On error, nlme_result is NULL.</p></li>
<li><p><code>plot</code> A ggplot graph of data and prediction. Plot of raw data is
     returned even when convergence was not achieved.</p></li>
<li><p><code>pnlsTol</code> Effective value of pnlsTo after convergence or failure.</p></li>
<li><p><code>message</code> String "Ok" on success, and the error message of
     <code>nlme</code> on failure.</p></li>
</ul>

    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>4711</span>)
<span class='no'>d</span> <span class='kw'>=</span> <span class='fu'>simulate_gastempt</span>(<span class='kw'>n_record</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>kappa_mean</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>kappa_std</span> <span class='kw'>=</span> <span class='fl'>0.3</span>,
                      <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>linexp</span>)$<span class='no'>data</span>
<span class='no'>fit_d</span> <span class='kw'>=</span> <span class='fu'>nlme_gastempt</span>(<span class='no'>d</span>)
<span class='co'># fit_d$coef # direct access</span>
<span class='fu'>coef</span>(<span class='no'>fit_d</span>) <span class='co'># better use accessor function</span></div><div class='output co'>#&gt;    record       v0     tempt     kappa       t50 slope_t50      auc
#&gt; 1  rec_01 514.2607  38.26811 0.9614496  62.74058  4.211646 38600.91
#&gt; 2  rec_02 494.2314  29.06204 0.7791218  42.10060  5.390813 25554.19
#&gt; 3  rec_03 474.9862  65.59182 0.9788629 108.69353  2.269089 61651.88
#&gt; 4  rec_04 409.2773  70.62819 0.6727137  94.17770  1.869939 48352.33
#&gt; 5  rec_05 364.8376  69.44864 0.4269848  74.25503  1.856661 36156.19
#&gt; 6  rec_06 342.5378 104.75966 0.6045985 131.91422  1.073679 57579.65
#&gt; 7  rec_07 438.8779  48.00170 0.6406723  62.33079  2.972712 34563.86
#&gt; 8  rec_08 370.9170  72.25500 0.4834587  81.54487  1.763868 39757.59
#&gt; 9  rec_09 396.2692  59.60433 0.5053634  68.65981  2.262369 35555.72
#&gt; 10 rec_10 446.1286  82.80564 0.9667277 136.20314  1.688396 72654.78</div><div class='input'><span class='fu'>coef</span>(<span class='no'>fit_d</span>, <span class='kw'>signif</span> <span class='kw'>=</span> <span class='fl'>3</span>) <span class='co'># Can also set number of digits</span></div><div class='output co'>#&gt;    record  v0 tempt kappa   t50 slope_t50   auc
#&gt; 1  rec_01 514  38.3 0.961  62.7      4.21 38600
#&gt; 2  rec_02 494  29.1 0.779  42.1      5.39 25600
#&gt; 3  rec_03 475  65.6 0.979 109.0      2.27 61700
#&gt; 4  rec_04 409  70.6 0.673  94.2      1.87 48400
#&gt; 5  rec_05 365  69.4 0.427  74.3      1.86 36200
#&gt; 6  rec_06 343 105.0 0.605 132.0      1.07 57600
#&gt; 7  rec_07 439  48.0 0.641  62.3      2.97 34600
#&gt; 8  rec_08 371  72.3 0.483  81.5      1.76 39800
#&gt; 9  rec_09 396  59.6 0.505  68.7      2.26 35600
#&gt; 10 rec_10 446  82.8 0.967 136.0      1.69 72700</div><div class='input'><span class='co'># Avoid ugly ggplot shading (not really needed...)</span>
<span class='fu'>library</span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme_get'>theme_set</a></span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme'>theme_bw</a></span>() + <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>panel.spacing</span> <span class='kw'>=</span> <span class='kw pkg'>grid</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/grid/topics/unit'>unit</a></span>(<span class='fl'>0</span>,<span class='st'>"lines"</span>)))
<span class='co'># fit_d$plot  # direct access is possible</span>
<span class='fu'>plot</span>(<span class='no'>fit_d</span>) <span class='co'># better use accessor function</span></div><div class='img'><img src='nlme_gastempt-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Dieter Menne.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

