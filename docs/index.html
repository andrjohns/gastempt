<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing gastric emptying functions • gastempt</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">gastempt</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/dmenne/gastempt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    

<div id="fitting-gastric-emptying-curves" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fitting-gastric-emptying-curves" class="anchor"></a>Fitting gastric emptying curves</h1></div>
<p>By <a href="mailto:dieter.menne@menne-biomed.de">dieter.menne@menne-biomed.de</a>, Menne Biomed Consulting Tübingen, D-72074 Tübingen</p>
<p>A package and a Shiny web application to create simulated gastric emptying data, and to analyze experimental gastric emptying data using population fit with R and package nlme. Simplified versions of Stan-based (<a href="http://mc-stan.org/" class="uri">http://mc-stan.org/</a>) Bayesian fits are included and will be extended in future.</p>
<blockquote>
<p>Part of the work has been supported by section GI MRT, Klinik für Gastroenterologie und Hepatologie, Universitätsspital Zürich; we thank Prof. Werner Schwizer and Dr. Andreas Steingötter for their contributions.</p>
</blockquote>
<div id="download" class="section level3">
<h3 class="hasAnchor">
<a href="#download" class="anchor"></a>Download</h3>
<p>The package is available from github: <a href="https://github.com/dmenne/gastempt" class="uri">https://github.com/dmenne/gastempt</a>. It can be installed with</p>
<pre><code>devtools::install_github("dmenne/gastempt")</code></pre>
<p>Compilation of the Stan models require several minutes.</p>
</div>
<div id="shiny-online-interface" class="section level3">
<h3 class="hasAnchor">
<a href="#shiny-online-interface" class="anchor"></a>Shiny online interface</h3>
<p>The web interface can be installed on your computer, or <a href="https://menne-biomed.shinyapps.io/gastempt/">run in ShinyApps</a>.</p>
<p>Two <strong>models</strong> are implemented in the web interface</p>
<ul>
<li>
<code>linexp, vol = v0 * (1 + kappa * t / tempt) * exp(-t / tempt):</code>Recommended for gastric emptying curves with an initial volume overshoot from secretion. With parameter kappa &gt; 1, there is a maximum after t=0. When all emptying curves start with a steep drop, this model can be difficult to fit.</li>
<li>
<code>powexp, vol = v0 * exp(-(t / tempt) ^ beta):</code> The power exponential function introduced by Elashof et. al. to fit scintigraphic emptying data; this type of data does not have an initial overshoot by design. Compared to the <code>linexp</code> model, fitting <code>powexp</code> is more reliable and rarely fails to converge in the presence of noise and outliers. The power exponential can be useful with MRI data when there is an unusual late phase in emptying.</li>
</ul>
</div>
<div id="methods-with-variants" class="section level3">
<h3 class="hasAnchor">
<a href="#methods-with-variants" class="anchor"></a>Methods with variants</h3>
<ul>
<li>Population fits based on function <code>nlme</code> in package R <code>nlme</code>.</li>
<li>
<a href="http://menne-biomed.de/blog/tag:Stan">Stan-based fits</a>, both <a href="https://github.com/dmenne/gastempt/blob/master/exec/linexp_gastro_1b.stan">without</a> and <a href="https://github.com/dmenne/gastempt/blob/master/exec/linexp_gastro_2b.stan">with</a> covariance estimation. Thanks to priors, fitting with Bayesian methods also works for single records, even if stability strongly improves with more data sets available. See the documentation of R function <a href="https://github.com/dmenne/gastempt/blob/master/R/stan_gastempt.R">stan_gastempt</a> in the package. Some details can be found in <a href="http://menne-biomed.de/blog/multiple-indexes-stan">my blog</a>. The rationale for using Stan to fit non-linear curves is discussed here for <a href="http://menne-biomed.de/blog/breath-test-stan"><sup>13</sup>C breath test data</a> and is equally valid for gastric emptying data.</li>
</ul>
</div>
<div id="data-entry" class="section level3">
<h3 class="hasAnchor">
<a href="#data-entry" class="anchor"></a>Data entry:</h3>
<ul>
<li>Data can be entered directly from the clipboard copied from Excel, or can be simulated using a Shiny app.</li>
<li>Several preset simulations are provided in the Shiny app, with different amounts of noise and outliers</li>
<li>Robustness of models can be tested by manipulating noise quality and between-subject variance.</li>
<li>Fits are displayed with data.</li>
<li>The coefficients of the analysis including t50 and the slope in t50 can be downloaded in .csv format.</li>
</ul>
</div>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>Program with simulated data (needs about 40 seconds till plot shows):</p>
<pre><code>library(gastempt)
dd = simulate_gastempt(n_records = 6, seed = 471)
d = dd$data
ret = stan_gastempt(d)
print(ret$coef)
print(ret$plot)</code></pre>
</div>
<div id="coming" class="section level3">
<h3 class="hasAnchor">
<a href="#coming" class="anchor"></a>Coming:</h3>
<ul>
<li>Post-hoc analysis in Shiny application by treatment groups, both for cross-over and fully randomized designs.</li>
</ul>
<p><img src="inst/shiny/screenshot.png" alt="Screenshot"></p>
</div>
</div>

  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="http://github.com/dmenne/gastempt">http://​github.com/​dmenne/​gastempt</a>
</li>
<li>Report a bug at <br><a href="http://github.com/dmenne/gastempt/issues">http://​github.com/​dmenne/​gastempt/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>GPL (&gt;=3)</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dieter Menne <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/dmenne/gastempt"><img src="https://travis-ci.org/dmenne/gastempt.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://coveralls.io/github/dmenne/gastempt?branch=master"><img src="https://coveralls.io/repos/github/dmenne/gastempt/badge.svg?branch=master" alt="Coverage Status"></a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dieter Menne.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
